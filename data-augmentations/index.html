
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="CNN-based chess piece classifier">
      
      
        <meta name="author" content="S1M0N38">
      
      
        <link rel="canonical" href="https://s1m0n38.github.io/chess-cv/data-augmentations/">
      
      
        <link rel="prev" href="../architecture/">
      
      
      
      <link rel="icon" href="../assets/logo.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>Data Augmentation - Chess CV</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="black">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#data-augmentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Chess CV" class="md-header__button md-logo" aria-label="Chess CV" data-md-component="logo">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Chess CV
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Data Augmentation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="black"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="white"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/S1M0N38/chess-cv" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    S1M0N38/chess-cv
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Chess CV" class="md-nav__button md-logo" aria-label="Chess CV" data-md-component="logo">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    Chess CV
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/S1M0N38/chess-cv" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    S1M0N38/chess-cv
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setup
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../inference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../train-and-eval/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Train and Evaluate
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Data Augmentation
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Data Augmentation
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pieces-model-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Pieces Model Pipeline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#arrows-model-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Arrows Model Pipeline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snap-model-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Snap Model Pipeline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-differences" class="md-nav__link">
    <span class="md-ellipsis">
      Key Differences
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pieces-model-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Pieces Model Pipeline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#arrows-model-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Arrows Model Pipeline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snap-model-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Snap Model Pipeline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-differences" class="md-nav__link">
    <span class="md-ellipsis">
      Key Differences
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="data-augmentation">Data Augmentation</h1>
<p>Documentation of data augmentation strategies used in training each model.</p>
<h2 id="configuration">Configuration</h2>
<p>Augmentation parameters are defined in <code>src/chess_cv/constants.py</code>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">AUGMENTATION_CONFIGS</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-2">    <span class="s2">&quot;pieces&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-3">        <span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
</span><span id="__span-0-4">        <span class="s2">&quot;padding_mode&quot;</span><span class="p">:</span> <span class="s2">&quot;edge&quot;</span><span class="p">,</span>
</span><span id="__span-0-5">        <span class="s2">&quot;rotation_degrees&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="__span-0-6">        <span class="s2">&quot;center_crop_size&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
</span><span id="__span-0-7">        <span class="s2">&quot;final_size&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
</span><span id="__span-0-8">        <span class="s2">&quot;resized_crop_scale&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.54</span><span class="p">,</span> <span class="mf">0.74</span><span class="p">),</span>
</span><span id="__span-0-9">        <span class="s2">&quot;resized_crop_ratio&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">),</span>
</span><span id="__span-0-10">        <span class="s2">&quot;arrow_probability&quot;</span><span class="p">:</span> <span class="mf">0.80</span><span class="p">,</span>
</span><span id="__span-0-11">        <span class="s2">&quot;highlight_probability&quot;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>
</span><span id="__span-0-12">        <span class="s2">&quot;move_probability&quot;</span><span class="p">:</span> <span class="mf">0.50</span><span class="p">,</span>
</span><span id="__span-0-13">        <span class="s2">&quot;mouse_probability&quot;</span><span class="p">:</span> <span class="mf">0.90</span><span class="p">,</span>
</span><span id="__span-0-14">        <span class="s2">&quot;horizontal_flip&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-15">        <span class="s2">&quot;horizontal_flip_prob&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
</span><span id="__span-0-16">        <span class="s2">&quot;brightness&quot;</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span>
</span><span id="__span-0-17">        <span class="s2">&quot;contrast&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
</span><span id="__span-0-18">        <span class="s2">&quot;saturation&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
</span><span id="__span-0-19">        <span class="s2">&quot;hue&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
</span><span id="__span-0-20">        <span class="s2">&quot;noise_mean&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="__span-0-21">        <span class="s2">&quot;noise_sigma&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
</span><span id="__span-0-22">    <span class="p">},</span>
</span><span id="__span-0-23">    <span class="s2">&quot;arrows&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-24">        <span class="s2">&quot;arrow_probability&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="__span-0-25">        <span class="s2">&quot;highlight_probability&quot;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>
</span><span id="__span-0-26">        <span class="s2">&quot;move_probability&quot;</span><span class="p">:</span> <span class="mf">0.50</span><span class="p">,</span>
</span><span id="__span-0-27">        <span class="s2">&quot;scale_min&quot;</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">,</span>
</span><span id="__span-0-28">        <span class="s2">&quot;scale_max&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span id="__span-0-29">        <span class="s2">&quot;horizontal_flip&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-30">        <span class="s2">&quot;brightness&quot;</span><span class="p">:</span> <span class="mf">0.20</span><span class="p">,</span>
</span><span id="__span-0-31">        <span class="s2">&quot;contrast&quot;</span><span class="p">:</span> <span class="mf">0.20</span><span class="p">,</span>
</span><span id="__span-0-32">        <span class="s2">&quot;saturation&quot;</span><span class="p">:</span> <span class="mf">0.20</span><span class="p">,</span>
</span><span id="__span-0-33">        <span class="s2">&quot;hue&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
</span><span id="__span-0-34">        <span class="s2">&quot;rotation_degrees&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="__span-0-35">        <span class="s2">&quot;noise_mean&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="__span-0-36">        <span class="s2">&quot;noise_sigma&quot;</span><span class="p">:</span> <span class="mf">0.10</span><span class="p">,</span>
</span><span id="__span-0-37">    <span class="p">},</span>
</span><span id="__span-0-38">    <span class="s2">&quot;snap&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-39">        <span class="s2">&quot;arrow_probability&quot;</span><span class="p">:</span> <span class="mf">0.50</span><span class="p">,</span>
</span><span id="__span-0-40">        <span class="s2">&quot;highlight_probability&quot;</span><span class="p">:</span> <span class="mf">0.20</span><span class="p">,</span>
</span><span id="__span-0-41">        <span class="s2">&quot;move_probability&quot;</span><span class="p">:</span> <span class="mf">0.50</span><span class="p">,</span>
</span><span id="__span-0-42">        <span class="s2">&quot;mouse_probability&quot;</span><span class="p">:</span> <span class="mf">0.80</span><span class="p">,</span>
</span><span id="__span-0-43">        <span class="s2">&quot;mouse_padding&quot;</span><span class="p">:</span> <span class="mi">134</span><span class="p">,</span>
</span><span id="__span-0-44">        <span class="s2">&quot;mouse_rotation_degrees&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
</span><span id="__span-0-45">        <span class="s2">&quot;mouse_center_crop_size&quot;</span><span class="p">:</span> <span class="mi">246</span><span class="p">,</span>
</span><span id="__span-0-46">        <span class="s2">&quot;mouse_final_size&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
</span><span id="__span-0-47">        <span class="s2">&quot;mouse_scale_range&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.30</span><span class="p">),</span>
</span><span id="__span-0-48">        <span class="s2">&quot;mouse_ratio_range&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span>
</span><span id="__span-0-49">        <span class="s2">&quot;horizontal_flip&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-50">        <span class="s2">&quot;horizontal_flip_prob&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
</span><span id="__span-0-51">        <span class="s2">&quot;brightness&quot;</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span>
</span><span id="__span-0-52">        <span class="s2">&quot;contrast&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
</span><span id="__span-0-53">        <span class="s2">&quot;saturation&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
</span><span id="__span-0-54">        <span class="s2">&quot;hue&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
</span><span id="__span-0-55">        <span class="s2">&quot;noise_mean&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="__span-0-56">        <span class="s2">&quot;noise_sigma&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
</span><span id="__span-0-57">    <span class="p">},</span>
</span><span id="__span-0-58"><span class="p">}</span>
</span></code></pre></div>
<hr />
<h2 id="pieces-model-pipeline">Pieces Model Pipeline</h2>
<div align="center">
<p><img alt="Pieces Original 1" src="../assets/pieces/01-original.png" style="margin: 0 10px;" width="75" />
<img alt="Pieces Original 2" src="../assets/pieces/02-original.png" style="margin: 0 10px;" width="75" />
<img alt="Pieces Original 3" src="../assets/pieces/03-original.png" style="margin: 0 10px;" width="75" />
<img alt="Pieces Original 4" src="../assets/pieces/04-original.png" style="margin: 0 10px;" width="75" /></p>
<p><img alt="Pieces Augmented 1" src="../assets/pieces/01-augmented.png" style="margin: 0 10px;" width="75" />
<img alt="Pieces Augmented 2" src="../assets/pieces/02-augmented.png" style="margin: 0 10px;" width="75" />
<img alt="Pieces Augmented 3" src="../assets/pieces/03-augmented.png" style="margin: 0 10px;" width="75" />
<img alt="Pieces Augmented 4" src="../assets/pieces/04-augmented.png" style="margin: 0 10px;" width="75" /></p>
<p><em>The first row shows original training images, while the second row displays their augmented versions for the pieces model.</em></p>
</div>
<p>Applied in order during training:</p>
<ol>
<li>
<p><strong>Expand Canvas</strong> (16px padding): Pads image by 16px on all sides using edge replication mode (32×32 → 64×64). Creates space for rotation without cropping piece edges.</p>
</li>
<li>
<p><strong>Random Rotation</strong> (±10°): Rotates image with black fill. More aggressive than previous ±5° to improve robustness.</p>
</li>
<li>
<p><strong>Center Crop</strong> (40×40): Removes black corners introduced by rotation using conservative formula: <code>64 - (ceil(tan(10°) × 64) × 2) = 40</code>. Ensures no rotation artifacts remain.</p>
</li>
<li>
<p><strong>Random Resized Crop</strong> (area scale 0.54-0.74, aspect ratio 0.9-1.1, output 32×32): Crops random region then resizes to 32×32. Base area ratio (32/40)² = 0.64 provides translation without zoom. Range 0.54-0.74 adds ±16% zoom variation. Aspect ratio 0.9-1.1 allows ±10% stretch for additional robustness.</p>
</li>
<li>
<p><strong>Arrow Overlay</strong> (80% probability): Overlays random arrow component from <code>data/arrows/</code>. Applied after geometric transforms to maintain crisp arrow graphics.</p>
</li>
<li>
<p><strong>Highlight Overlay</strong> (25% probability): Overlays semi-transparent highlight from <code>data/highlights/</code>.</p>
</li>
<li>
<p><strong>Move Overlay</strong> (50% probability): Overlays random move indicator (dot/ring) from <code>data/moves/</code>. Simulates move annotations on pieces during gameplay.</p>
</li>
<li>
<p><strong>Mouse Overlay</strong> (90% probability): Overlays random mouse cursor from <code>data/mouse/</code> with geometric transformations. Applies padding (134px), small rotation (±5°), center crop (246×246), random resized crop to final size (32×32) with scale 0.20-0.30 and ratio 0.8-1.2, making cursor smaller and positioning it randomly on the piece.</p>
</li>
<li>
<p><strong>Horizontal Flip</strong> (50% probability): Flips image left-to-right.</p>
</li>
<li>
<p><strong>Color Jitter</strong>: Randomly adjusts brightness (±15%), contrast (±20%), saturation (±20%), and hue (±20%).</p>
</li>
<li>
<p><strong>Gaussian Noise</strong> (σ=0.05): Adds noise to normalized [0,1] pixels.</p>
</li>
</ol>
<hr />
<h2 id="arrows-model-pipeline">Arrows Model Pipeline</h2>
<div align="center">
<p><img alt="Arrows Original 1" src="../assets/arrows/01-original.png" style="margin: 0 10px;" width="75" />
<img alt="Arrows Original 2" src="../assets/arrows/02-original.png" style="margin: 0 10px;" width="75" />
<img alt="Arrows Original 3" src="../assets/arrows/03-original.png" style="margin: 0 10px;" width="75" />
<img alt="Arrows Original 4" src="../assets/arrows/04-original.png" style="margin: 0 10px;" width="75" /></p>
<p><img alt="Arrows Augmented 1" src="../assets/arrows/01-augmented.png" style="margin: 0 10px;" width="75" />
<img alt="Arrows Augmented 2" src="../assets/arrows/02-augmented.png" style="margin: 0 10px;" width="75" />
<img alt="Arrows Augmented 3" src="../assets/arrows/03-augmented.png" style="margin: 0 10px;" width="75" />
<img alt="Arrows Augmented 4" src="../assets/arrows/04-augmented.png" style="margin: 0 10px;" width="75" /></p>
<p><em>The first row shows original training images, while the second row displays their augmented versions for the arrows model.</em></p>
</div>
<p>Applied in order during training:</p>
<ol>
<li>
<p><strong>Highlight Overlay</strong> (25% probability): Overlays semi-transparent highlight from <code>data/highlights/</code>. Applied early before other transforms.</p>
</li>
<li>
<p><strong>Move Overlay</strong> (50% probability): Overlays random move indicator (dot/ring) from <code>data/moves/</code>. Simulates move annotations on arrow components.</p>
</li>
<li>
<p><strong>Color Jitter</strong>: Randomly adjusts brightness, contrast, saturation by ±20%, and hue by ±20%.</p>
</li>
<li>
<p><strong>Random Rotation</strong> (±2°): Small rotation to preserve arrow directionality.</p>
</li>
<li>
<p><strong>Gaussian Noise</strong> (σ=0.10): Adds noise to normalized [0,1] pixels. Higher noise than pieces model.</p>
</li>
</ol>
<hr />
<h2 id="snap-model-pipeline">Snap Model Pipeline</h2>
<div align="center">
<p><img alt="Snap Original 1" src="../assets/snap/01-original.png" style="margin: 0 10px;" width="75" />
<img alt="Snap Original 2" src="../assets/snap/02-original.png" style="margin: 0 10px;" width="75" />
<img alt="Snap Original 3" src="../assets/snap/03-original.png" style="margin: 0 10px;" width="75" />
<img alt="Snap Original 4" src="../assets/snap/04-original.png" style="margin: 0 10px;" width="75" /></p>
<p><img alt="Snap Augmented 1" src="../assets/snap/01-augmented.png" style="margin: 0 10px;" width="75" />
<img alt="Snap Augmented 2" src="../assets/snap/02-augmented.png" style="margin: 0 10px;" width="75" />
<img alt="Snap Augmented 3" src="../assets/snap/03-augmented.png" style="margin: 0 10px;" width="75" />
<img alt="Snap Augmented 4" src="../assets/snap/04-augmented.png" style="margin: 0 10px;" width="75" /></p>
<p><em>The first row shows original training images with varying piece centering, while the second row displays their augmented versions for the snap model.</em></p>
</div>
<p>Applied during preprocessing:</p>
<ol>
<li>
<p><strong>Piece Positioning</strong>: Applies translation to simulate different degrees of misalignment:</p>
<ul>
<li>"ok" class: 0-2px shifts (minimal/slight misalignment)</li>
<li>"bad" class: 3-14px shifts (significant misalignment)</li>
</ul>
</li>
<li>
<p><strong>Zoom Variation</strong>: Applies (-10%, +15%) random scaling to both classes for zoom robustness. Scaling is applied around the image center to preserve centering semantics while making the model resistant to different zoom levels.</p>
</li>
</ol>
<p>Applied in order during training:</p>
<ol>
<li>
<p><strong>Arrow Overlay</strong> (50% probability): Overlays random arrow component from <code>data/arrows/</code>. Applied early to simulate realistic interface conditions where arrows may be present during piece positioning.</p>
</li>
<li>
<p><strong>Highlight Overlay</strong> (20% probability): Overlays semi-transparent highlight from <code>data/highlights/</code>. Simulates square highlighting that may occur during piece placement.</p>
</li>
<li>
<p><strong>Move Overlay</strong> (50% probability): Overlays random move indicator (dot/ring) from <code>data/moves/</code>. Simulates move indicators during piece positioning evaluation.</p>
</li>
<li>
<p><strong>Mouse Cursor Overlay</strong> (80% probability): Overlays random mouse cursor from <code>data/mouse/</code> with geometric transformations. Applies padding (134px), small rotation (±5°), center crop (246×246), random resized crop to final size (32×32) with scale 0.20-0.30 and ratio 0.8-1.2, making cursor smaller and positioning it randomly on the piece.</p>
</li>
<li>
<p><strong>Horizontal Flip</strong> (50% probability): Flips image left-to-right. Centering semantics are preserved under horizontal flip.</p>
</li>
<li>
<p><strong>Color Jitter</strong>: Randomly adjusts brightness (±15%), contrast (±20%), saturation (±20%), and hue (±20%).</p>
</li>
</ol>
<p><strong>Note:</strong> The snap model uses <strong>conservative augmentation</strong> during training with no additional geometric transformations like rotation, cropping, or further scaling beyond the zoom variation in preprocessing. This preserves piece centering semantics—the model needs to distinguish between properly centered and poorly positioned pieces. Zoom variation in preprocessing (-10%, +15%) provides robustness to different zoom levels while maintaining the fundamental centering distinction.</p>
<hr />
<h2 id="key-differences">Key Differences</h2>
<table>
<thead>
<tr>
<th>Augmentation</th>
<th>Pieces</th>
<th>Arrows</th>
<th>Snap</th>
<th>Reason</th>
</tr>
</thead>
<tbody>
<tr>
<td>Canvas Expansion</td>
<td>16px edge padding (32→64)</td>
<td>❌</td>
<td>❌</td>
<td>Creates rotation space without edge cropping</td>
</tr>
<tr>
<td>Rotation</td>
<td>±10°</td>
<td>±2°</td>
<td>❌</td>
<td>Snap needs to preserve centering semantics</td>
</tr>
<tr>
<td>Center Crop</td>
<td>40×40 (removes black corners)</td>
<td>❌</td>
<td>❌</td>
<td>Removes rotation artifacts</td>
</tr>
<tr>
<td>Random Resized Crop</td>
<td>Area 0.54-0.74, ratio 0.9-1.1</td>
<td>❌</td>
<td>❌</td>
<td>Translation + zoom would alter centering</td>
</tr>
<tr>
<td>Arrow Overlay</td>
<td>80%</td>
<td>❌</td>
<td>50%</td>
<td>Simulates interface arrows during positioning</td>
</tr>
<tr>
<td>Highlight Overlay</td>
<td>25%</td>
<td>25%</td>
<td>20%</td>
<td>Simulates square highlighting</td>
</tr>
<tr>
<td>Move Overlay</td>
<td>50%</td>
<td>50%</td>
<td>50%</td>
<td>Simulates move indicators on pieces/arrows</td>
</tr>
<tr>
<td>Mouse Overlay</td>
<td>90%</td>
<td>❌</td>
<td>80%</td>
<td>Simulates cursor interaction during placement</td>
</tr>
<tr>
<td>Horizontal Flip</td>
<td>50%</td>
<td>❌</td>
<td>50%</td>
<td>Centering semantics preserved under flip</td>
</tr>
<tr>
<td>Color Jitter</td>
<td>B±15%, CSH±20%</td>
<td>±20% (BCSH)</td>
<td>B±15%, CSH±20%</td>
<td>Snap uses same variation as pieces</td>
</tr>
<tr>
<td>Gaussian Noise</td>
<td>σ=0.05</td>
<td>σ=0.10</td>
<td>σ=0.05</td>
<td>Snap uses same noise level as pieces</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="implementation">Implementation</h2>
<p>The training script (<code>src/chess_cv/train.py</code>) constructs the pipeline dynamically based on model type:</p>
<p><strong>Pieces Model:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><span class="c1"># 1. Expand canvas (32×32 → 64×64)</span>
</span><span id="__span-1-2"><span class="n">v2</span><span class="o">.</span><span class="n">Pad</span><span class="p">(</span><span class="n">padding</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">padding_mode</span><span class="o">=</span><span class="s2">&quot;edge&quot;</span><span class="p">)</span>
</span><span id="__span-1-3">
</span><span id="__span-1-4"><span class="c1"># 2. Rotate with black fill</span>
</span><span id="__span-1-5"><span class="n">v2</span><span class="o">.</span><span class="n">RandomRotation</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-1-6">
</span><span id="__span-1-7"><span class="c1"># 3. Remove black rotation artifacts (64×64 → 40×40)</span>
</span><span id="__span-1-8"><span class="c1"># Formula: 64 - (ceil(tan(10°) × 64) × 2) = 40</span>
</span><span id="__span-1-9"><span class="n">v2</span><span class="o">.</span><span class="n">CenterCrop</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</span><span id="__span-1-10">
</span><span id="__span-1-11"><span class="c1"># 4. Random crop + zoom + resize (40×40 → 32×32)</span>
</span><span id="__span-1-12"><span class="c1"># Area scale: (32/40)² ± 0.1 = 0.64 ± 0.1 → (0.54, 0.74)</span>
</span><span id="__span-1-13"><span class="c1"># Aspect ratio: ±10% stretch → (0.9, 1.1)</span>
</span><span id="__span-1-14"><span class="n">v2</span><span class="o">.</span><span class="n">RandomResizedCrop</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mf">0.54</span><span class="p">,</span> <span class="mf">0.74</span><span class="p">),</span> <span class="n">ratio</span><span class="o">=</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">))</span>
</span><span id="__span-1-15">
</span><span id="__span-1-16"><span class="c1"># 5-8. Overlays</span>
</span><span id="__span-1-17"><span class="n">RandomArrowOverlay</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="mf">0.80</span><span class="p">)</span>
</span><span id="__span-1-18"><span class="n">RandomHighlightOverlay</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
</span><span id="__span-1-19"><span class="n">RandomMoveOverlay</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="mf">0.50</span><span class="p">)</span>
</span><span id="__span-1-20"><span class="n">RandomMouseOverlay</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="mf">0.90</span><span class="p">)</span>
</span><span id="__span-1-21">
</span><span id="__span-1-22"><span class="c1"># 9-10. Geometric + color</span>
</span><span id="__span-1-23"><span class="n">v2</span><span class="o">.</span><span class="n">RandomHorizontalFlip</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="__span-1-24"><span class="n">v2</span><span class="o">.</span><span class="n">ColorJitter</span><span class="p">(</span><span class="n">brightness</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">contrast</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">saturation</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</span><span id="__span-1-25">
</span><span id="__span-1-26"><span class="c1"># 11. Noise (requires tensor conversion)</span>
</span><span id="__span-1-27"><span class="n">v2</span><span class="o">.</span><span class="n">ToImage</span><span class="p">()</span> <span class="err">→</span> <span class="n">v2</span><span class="o">.</span><span class="n">ToDtype</span><span class="p">()</span> <span class="err">→</span> <span class="n">v2</span><span class="o">.</span><span class="n">GaussianNoise</span><span class="p">()</span> <span class="err">→</span> <span class="n">v2</span><span class="o">.</span><span class="n">ToPILImage</span><span class="p">()</span>
</span></code></pre></div>
<p><strong>Arrows Model:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><span class="c1"># 1. Highlight overlay</span>
</span><span id="__span-2-2"><span class="n">RandomHighlightOverlay</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
</span><span id="__span-2-3">
</span><span id="__span-2-4"><span class="c1"># 2. Move overlay</span>
</span><span id="__span-2-5"><span class="n">RandomMoveOverlay</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="mf">0.50</span><span class="p">)</span>
</span><span id="__span-2-6">
</span><span id="__span-2-7"><span class="c1"># 3-4. Color + rotation</span>
</span><span id="__span-2-8"><span class="n">v2</span><span class="o">.</span><span class="n">ColorJitter</span><span class="p">(</span><span class="n">brightness</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">contrast</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">saturation</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</span><span id="__span-2-9"><span class="n">v2</span><span class="o">.</span><span class="n">RandomRotation</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-2-10">
</span><span id="__span-2-11"><span class="c1"># 5. Noise (requires tensor conversion)</span>
</span><span id="__span-2-12"><span class="n">v2</span><span class="o">.</span><span class="n">ToImage</span><span class="p">()</span> <span class="err">→</span> <span class="n">v2</span><span class="o">.</span><span class="n">ToDtype</span><span class="p">()</span> <span class="err">→</span> <span class="n">v2</span><span class="o">.</span><span class="n">GaussianNoise</span><span class="p">()</span> <span class="err">→</span> <span class="n">v2</span><span class="o">.</span><span class="n">ToPILImage</span><span class="p">()</span>
</span></code></pre></div>
<p><strong>Snap Model:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><span class="c1"># 1-4. Overlays</span>
</span><span id="__span-3-2"><span class="n">RandomArrowOverlay</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="mf">0.50</span><span class="p">)</span>
</span><span id="__span-3-3"><span class="n">RandomHighlightOverlay</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="mf">0.20</span><span class="p">)</span>
</span><span id="__span-3-4"><span class="n">RandomMoveOverlay</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="mf">0.50</span><span class="p">)</span>
</span><span id="__span-3-5"><span class="n">RandomMouseOverlay</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="mf">0.80</span><span class="p">)</span>
</span><span id="__span-3-6">
</span><span id="__span-3-7"><span class="c1"># 5-6. Geometric + color</span>
</span><span id="__span-3-8"><span class="n">v2</span><span class="o">.</span><span class="n">RandomHorizontalFlip</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="__span-3-9"><span class="n">v2</span><span class="o">.</span><span class="n">ColorJitter</span><span class="p">(</span><span class="n">brightness</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">contrast</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">saturation</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</span><span id="__span-3-10">
</span><span id="__span-3-11"><span class="c1"># 7. Noise (requires tensor conversion)</span>
</span><span id="__span-3-12"><span class="n">v2</span><span class="o">.</span><span class="n">ToImage</span><span class="p">()</span> <span class="err">→</span> <span class="n">v2</span><span class="o">.</span><span class="n">ToDtype</span><span class="p">()</span> <span class="err">→</span> <span class="n">v2</span><span class="o">.</span><span class="n">GaussianNoise</span><span class="p">()</span> <span class="err">→</span> <span class="n">v2</span><span class="o">.</span><span class="n">ToPILImage</span><span class="p">()</span>
</span></code></pre></div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "content.tabs.link"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>